knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(echo = FALSE)
msps<- speeches %>% select(display_as, name, parl_id, party, gender, constituency, region, msp_type, wikidataid, party.facts.id)
if(!require("pacman"))install.packages("pacman")
pacman::p_load("tidyverse", "reticulate", "here")
knitr::opts_chunk$set(echo = FALSE)
harvard <- read.csv(here("data_raw", "rawdata.csv"))
if(!require("pacman"))install.packages("pacman")
pacman::p_load("tidyverse", "reticulate", "here")
harvard <- read.csv(here("data_raw", "rawdata.csv"))
source(here("scripts", "download-csv-html.R")) # once you have run the script once, you can comment out this line by typing "#" in front of it. Doing this will mean the data loads directly from your local data_raw folder rather than downloading every time.
source(here("scripts", "download-csv-http.R")) # once you have run the script once, you can comment out this line by typing "#" in front of it. Doing this will mean the data loads directly from your local data_raw folder rather than downloading every time.
source(here("scripts", "download-csv-http.R")) # once you have run the script once, you can comment out this line by typing "#" in front of it. Doing this will mean the data loads directly from your local data_raw folder rather than downloading every time.
harvard <- read.csv(here("data_raw", "rawdata.csv"))
speeches <- subset(harvard, harvard$is_speech == 1)
# Analysis replication in R
# Load packages
if(!require("here"))install.packages("here")
source(here("scripts", "r-packages.R"))
# Load data
harvard <- read.csv(here("data_raw", "rawdata.csv"))
speeches <- harvard %>% filter(is_speech == 1)
rm(harvard)
speeches <- speeches %>% filter(!is.na(parl_id)) # drop all without parl_id
# define counts of speeches
n_speeches <- nrow(speeches)
n_speeches_f <- speeches %>%
subset(speeches$gender == "F") %>%
nrow()
n_speeches_m <- speeches %>%
subset(speeches$gender == "M") %>%
nrow()
prop_speeches_f <- n_speeches_f/n_speeches
prop_speeches_m <- n_speeches_m/n_speeches
prop_speeches_m + prop_speeches_f
MSPs_all <- speeches %>%
select(parl_id, name, gender, wikidataid) %>%
unique()
# By parliament
source(here("scripts", "analysis-by-parly.R"))
# n_m | n_f | p_m | p_f
n_m <- c(n_speeches_m1, n_speeches_m2, n_speeches_m3, n_speeches_m4, n_speeches_m5)
n_f <- c(n_speeches_f1, n_speeches_f2, n_speeches_f3, n_speeches_f4, n_speeches_f5)
p_m <- c(prop_speeches_m1, prop_speeches_m2, prop_speeches_m3, prop_speeches_m4, prop_speeches_m5)
p_f <- c(prop_speeches_f1, prop_speeches_f2, prop_speeches_f3, prop_speeches_f4, prop_speeches_f5)
summary <- data.frame(n_m, n_f, p_m, p_f)
rownames(summary) <- c("First Parliament", "Second Parliament", "Third Parliament", "Fourth Parliament", "Fifth Parliament")
colnames(summary) <- c("Number speeches by men", "Number of speeches by women", "Proportion of speeches by men", "Proportion of speeches by women")
write.csv(here("output_data", "summary.csv"))
# explore different types of speeches
types <- data.frame(unique(speeches$item))
write.csv(summary, here("output_data", "summary.csv"))
data <- read.csv(here("output_data", "summary.csv"))
#
if(!require("here"))install.packages("here")
data <- read.csv(here("output_data", "summary.csv"))
View(data)
# Load data
harvard <- read.csv(here("data_raw", "rawdata.csv"))
speeches <- harvard %>% filter(is_speech == 1)
source(here("scripts", "r-packages.R"))
speeches <- harvard %>% filter(is_speech == 1)
rm(harvard)
speeches <- speeches %>% filter(!is.na(parl_id)) # drop all without parl_id
years <- read.csv(here("data_raw", "years.csv"))
View(years)
years$Election.Date <- as.Date(years$Election.Date, format = "%d-%m-%Y")
years$Dissolution.Date <- as.Date(years$Dissolution.Date, format = "%d-%m-%Y")
speeches$date <- as.Date(speeches$date, format = "%Y-%m-%d")
speeches$parly <- ifelse(speeches$date >= years[1,2] & speeches$date <= years[1,3], "First Scottish Parliament",
ifelse(speeches$date >= years[2,2] & speeches$date <= years[2,3], "Second Scottish Parliament",
ifelse(speeches$date >= years[3,2] & speeches$date <= years[3,3], "Third Scottish Parliament",
ifelse(speeches$date >= years[4,2] & speeches$date <= years[4,3], "Fourth Scottish Parliament",
ifelse(speeches$date >= years[5,2] & speeches$date <= years[5,3], "Fifth Scottish Parliament",
ifelse(speeches$date >= years[6,2], "Sixth Scottish Parliament",
NA))))))
speeches_1 <- speeches %>% subset(speeches$parly == "First Scottish Parliament")
speeches_2 <- speeches %>% subset(speeches$parly == "Second Scottish Parliament")
speeches_3 <- speeches %>% subset(speeches$parly == "Third Scottish Parliament")
speeches_4 <- speeches %>% subset(speeches$parly == "Fourth Scottish Parliament")
speeches_5 <- speeches %>% subset(speeches$parly == "Fifth Scottish Parliament")
MSPs_1 <- speeches_1 %>%
select(parl_id, name, gender, wikidataid, constituency, region, msp_type, office_held) %>%
unique()
MSPs_1$parly <- "First Scottish Parliament"
MSPs_2 <- speeches_2 %>%
select(parl_id, name, gender, wikidataid, constituency, region, msp_type, office_held) %>%
unique()
MSPs_2$parly <- "Second Scottish Parliament"
MSPs_3 <- speeches_3 %>%
select(parl_id, name, gender, wikidataid, constituency, region, msp_type, office_held) %>%
unique()
MSPs_3$parly <- "Third Scottish Parliament"
MSPs_4 <- speeches_4 %>%
select(parl_id, name, gender, wikidataid, constituency, region, msp_type, office_held) %>%
unique()
MSPs_4$parly <- "Fourth Scottish Parliament"
MSPs_5 <- speeches_5 %>%
select(parl_id, name, gender, wikidataid, constituency, region, msp_type, office_held) %>%
unique()
MSPs_5$parly <- "Fifth Scottish Parliament"
View(MSPs_4)
View(MSPs_1)
MSPs_agg <- rbind(MSPs_1, MSPs_2, MSPs_3, MSPs_4, MSPs_5)
speeches_1 <- speeches_1 %>%
select(date, name, parl_id, speech, item, type, committee, parly)
speeches_1 <- unique(speeches_1)
speeches_2 <- speeches_2 %>%
select(date, name, parl_id, speech, item, type, committee, parly)
speeches_2 <- unique(speeches_2)
speeches_3 <- speeches_3 %>%
select(date, name, parl_id, speech, item, type, committee, parly)
speeches_3 <- unique(speeches_3)
speeches_4 <- speeches_4 %>%
select(date, name, parl_id, speech, item, type, committee, parly)
speeches_4 <- unique(speeches_4)
speeches_5 <- speeches_5 %>%
select(date, name, parl_id, speech, item, type, committee, parly)
speeches_5 <- unique(speeches_5)
# bind back
speeches <- rbind(speeches_1, speeches_2, speeches_3, speeches_4, speeches_5)
View(speeches)
View(MSPs_agg)
View(speeches)
View(speeches)
View(MSPs_agg)
View(MSPs_agg)
View(speeches)
write.csv(speeches, here("output_data", "MSPs.csv"))
write.csv(MSPs_agg, here("output_data", "MSPs.csv"))
if(!require("sylcount"))install.packages("sylcount")
View(speeches)
speeches$syls <- sylcount(speeches$speech)
View(speeches)
class(speeches$syls)
speeches$syls2 <- sum(speeches$syls)
speeches$syls2 <- Reduce(speeches$syls)
speeches$syls2 <- Reduce(",", speeches$syls)
speeches$syls2 <- Reduce(",", speeches$syls)
speeches$syls2 <- sapply(speeches$syls, sum)
speeches_1$syls <- sylcount(speeches_1$speech)
speeches_1$syls <- sapply(speeches_1$syls, sum)
speeches_syl <- rbind(speeches_1, speeches_2, speeches_3, speeches_4, speeches_5)
speeches_2$syls <- sylcount(speeches_2$speech)
speeches_2$syls <- sapply(speeches_2$syls, sum)
speeches_3$syls <- sylcount(speeches_3$speech)
speeches_3$syls <- sapply(speeches_3$syls, sum)
speeches_4$syls <- sylcount(speeches_4$speech)
speeches_4$syls2 <- sapply(speeches_4$syls, sum)
speeches_5$syls <- sylcount(speeches_5$speech)
speeches_5$syls2 <- sapply(speeches_5$syls, sum)
speeches_syl <- rbind(speeches_1, speeches_2, speeches_3, speeches_4, speeches_5)
View(speeches_4)
View(speeches_1)
syls_1 <- speeches_1 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
View(syls_1)
syls_2 <- speeches_2 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
syls_3 <- speeches_3 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
syls_4 <- speeches_4 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
syls_5 <- speeches_5 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
View(syls_3)
syls_4 <- speeches_4 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
View(speeches_4)
syls_4 <- speeches_4 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
syls_5 <- speeches_5 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
syls_3 <- speeches_3 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
View(speeches_5)
speeches_5$syls2 <- NULL
speeches_4$syls2 <- NULL
syls_4 <- speeches_4 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
syls_5 <- speeches_5 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
View(speeches_1)
View(syls_1)
syls_4 <- speeches_4 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
library(dplyr)
syls_4 <- speeches_4 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
detach(package:plyr)
library(dplyr)
syls_4 <- speeches_4 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
View(speeches_4)
speeches_4$syls <- sylcount(speeches_4$speech)
speeches_4$syls <- sapply(speeches_4$syls, sum)
speeches_5$syls <- sylcount(speeches_5$speech)
speeches_5$syls <- sapply(speeches_5$syls, sum)
speeches_syl <- rbind(speeches_1, speeches_2, speeches_3, speeches_4, speeches_5)
syls_4 <- speeches_4 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
syls_5 <- speeches_5 %>%
group_by(parl_id) %>%
summarise(syls = sum(syls))
View(speeches_5)
syls_all <- rbind(syls_1, syls_2, syls_3, syls_4, syls_5)
syls_all <- rbind(syls_1, syls_2, syls_3, syls_4, syls_5)
View(syls_all)
